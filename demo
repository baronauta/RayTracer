#!/usr/bin/env julia

using Pkg
Pkg.activate(normpath(@__DIR__))

using RayTracer
import Crayons # enables colorful and expressive terminal output

function main()
    try
        params = RayTracer.demo_Params(ARGS)
        if params.mode == "image"
            RayTracer.demo_image(params.width, params.height, params.camera, params.angle_deg, params.renderer; n_rays=params.n_rays, max_depth=params.max_depth)
        elseif params.mode == "video"
            RayTracer.demo_video(params.width, params.height, params.camera, params.renderer; n_rays=params.n_rays, max_depth=params.max_depth)
        else
            throw(RuntimeError(demo_error))
        end
    catch e
        # Define colors for the error message
        red_bold = Crayons.crayon"bold red"  # Bold red text
        reset = Crayons.crayon"reset"        # Reset color to default
        
        # Print the formatted error message
        println(string(red_bold) * "ERROR " * string(reset), "$(typeof(e)): $(e.msg)")
    end
end

# execution
main()